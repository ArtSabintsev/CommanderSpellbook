<!DOCTYPE html>

<html>

<head>
  <!--Meta-->
  <title>Commander Spellbook - Combo Database for Commander (EDH)</title>
  <meta name="description"
    content="The Premier Magic: the Gathering Combo Database for the Commander / Elder Dragon Highlander (EDH) Format.">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!--Favicon-->
  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
  <link rel="manifest" href="favicon/site.webmanifest">

   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=G-0LPW4VGE0F"></script>
   <script>
     window.dataLayer = window.dataLayer || [];
 
     function gtag() {
       dataLayer.push(arguments);
     }
     gtag('js', new Date());
 
     gtag('config', 'G-0LPW4VGE0F');
   </script>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
  </script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous">
  </script>

  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <!-- Deckbox -->
  <script src="https://deckbox.org/assets/external/tooltip.js"></script>

  <!-- Internal CSS -->
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>
  <!--Nav Bar-->
  <nav class="navbar navbar-expand-xl navbar-light bg-light">
    <a class="navbar-brand" href="#">Commander Spellbook</a>
    <span class="navbar-text">
      Combo Database for EDH
    </span>
    <button class="navbar-toggler navbar-right" type="button" data-toggle="collapse" data-target="#navbar"
      aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar">
      <ul class="nav navbar-nav navbar-right ml-auto">
        <li class="nav-item">
          <button class="btn btn-success d-none d-lg-inline-block" data-toggle="modal"
            data-target="#submitComboModal">Submit</button>
          <a class="d-inline d-lg-none" role="button" data-toggle="modal" data-target="#submitComboModal">Submit a
            Combo</a>
        </li>
        <li class="nav-item">
          <a class="btn btn-dark d-none d-lg-inline-block" role="button" target="_blank"
            href="https://discord.com/invite/DkAyVJG">Discord</a>
          <a class="d-inline d-lg-none" role="button" target="_blank"
            href="https://discord.com/invite/DkAyVJG">Discord</a>
        </li>
        <li class="nav-item">
          <button class="btn btn-dark d-none d-lg-inline-block" data-toggle="modal"
            data-target="#metricsModal">Metrics</button>
          <a class="d-inline d-lg-none" role="button" data-toggle="modal" data-target="#metricsModal">Combo Metrics</a>
        </li>
        <li class="nav-item">
          <button class="btn btn-dark d-none d-lg-inline-block" data-toggle="modal"
            data-target="#dataModal">Database</button>
          <a class="d-inline d-lg-none" role="button" data-toggle="modal" data-target="#metricsModal">Data</a>
        </li>
      </ul>
    </div>
  </nav>

  <!--Combos Table-->
  <div style="display:flex;">
    <input class="form-control" id="card-input" ftype="text" placeholder="Loading Combos..." onkeyup="filterCombos()" >
    <button class="btn btn-dark d-none d-lg-inline-block" data-toggle="modal" data-target="#searchModal" style="margin-bottom:10px;">Advanced Search</button>
  </div>
  <div class="container-fluid" id="global">
    
    <!-- Load metrics.js -->
    <script src="js/metrics.js"></script>

    <div class="table-responive-sm">
      <table class="table" id="no-more-tables">
        <thead>
          <tr>
            <th width="15%">
              <center>CARDS</center>
            </th>
            <th width="15%">
              <center>IDENTITY</center>
            </th>
            <th width="20%">
              <center>PREREQUISITES</center>
            </th>
            <th width="30%">
              <center>STEPS</center>
            </th>
            <th width="20%">
              <center>RESULT</center>
            </th>
          </tr>
        </thead>
        <tbody id="combos"></tbody>
      </table>
    </div>
  </div>

  <!-- Submit Combo Modal -->
  <div class="modal fade" id="submitComboModal" tabindex="-1" role="dialog" aria-labelledby="submitComboModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="submitComboModalLabel">Want to Submit a Combo?</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          At this time, combo submissions are only being accepted via <a target="_blank"
            href="https://discord.gg/KDnvP5f">Discord</a>, as we've learned from experience that
          many of them require a discussion. If your combo isn't listed here, please join us on that platform to
          contribute to the catalog.
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <a role="button" class="btn btn-success" target="_blank" href="https://discord.gg/KDnvP5f">Join us on
            Discord</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Metrics Modal -->
  <div class="modal fade" id="metricsModal" tabindex="-1" role="dialog" aria-labelledby="metricsModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="metricsModalLabel">Commander Spellbook Combo Metrics</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <table class="table">
            <thead>
              <tr>
                <th width="38%">
                  <center>METRIC</center>
                </th>
                <th width="57%">
                  <center>IDENTITY</center>
                </th>
                <th width="5%">
                  <center>COUNT</center>
                </th>
              </tr>
            </thead>
            <tbody id="metrics"></tbody>
          </table>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Data Modal -->
  <div class="modal fade" id="dataModal" tabindex="-1" role="dialog" aria-labelledby="dataLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="dataLabel">Source Code, Database, and API</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          The data powering the website, and the source code for the website itself, are completely free and open
          source.
          <p>We encourage you copy and clone this data!</p>
          <ul>
            <li><a target="_blank" href="https://github.com/ArtSabintsev/CommanderSpellbook">Website Source Code on
                GitHub</a></li>
            <li><a target="_blank"
                href="https://docs.google.com/spreadsheets/d/1JJo8MzkpuhfvsaKVFVlOoNymscCt-Aw-1sob2IhpwXY/">Combo
                Database Backend on Google Sheets</a></li>
            <li><a target="_blank"
                href="https://sheets.googleapis.com/v4/spreadsheets/1JJo8MzkpuhfvsaKVFVlOoNymscCt-Aw-1sob2IhpwXY/values:batchGet?ranges=combos!A2:O&key=AIzaSyDzQ0jCf3teHnUK17ubaLaV6rcWf9ZjG5E">Combo
                Database GET API on Google Sheets</a></li>
          </ul>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Advanced Search Modal -->
  <div class="modal fade" id="searchModal" tabindex="-1" role="dialog" aria-labelledby="searchLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="searchLabel">Advanced Search</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div id="identityContainer" style="display: flex">
            <p style="white-space: nowrap">
            Color Identity <a id="identityColorsDisplay"></a>: 
          </p>
          <input class="form-control" id="identity" onkeyup="colorIdentity()" style="flex-shrink: 1">
          </div>
          <div id="resultsContainer" style="display: flex">
            <p style="white-space: nowrap">
            Combo Results <a id="identityColorsDisplay"></a>: 
          </p>
          <input class="form-control" id="results" style="flex-shrink: 1">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="advancedSearch()">Search</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Filter Combo Table -->
  <script>
    function isBlank(str) {
        return (!str || /^\s*$/.test(str));
    }
    function tableStriping() {
        // Re-apply table striping on search
        $("tr:visible").each(function (index) {
          $(this).css("background-color", !!(index & 1) ? "rgba(0,0,0,.05)" : "rgba(0,0,0,0)");
        });
    };
    function filterCombos() {
      filter = $("#card-input").val().toLowerCase();
        // $("#combos tr #tdCardLinks").filter(function () { // Search only Cards
        $("#combos tr").filter(function () {
          let matchedText = $(this).text().toLowerCase().indexOf(filter)
          // $(this).parent().toggle(matchedText > -1) // Toggle to use if searching only cards
          $(this).toggle(matchedText > -1)
        });
        tableStriping();
    };
    function colorIdentity() {
      aOpen = "<a id='identityColorsDisplay' style='color: red;'>";
      aClose = "</a>"
      $("#identityColorsDisplay").html(aOpen + 
        replaceColorIdentityWithMiniImageSources(
          replaceNameWithColorIdentity(
            $("#identity").val()
          )
        ) + 
        aClose
      );
    }
    function advancedSearch() {
      let identityName = $("#identity").val();
      let results = $("#results").val();
      if(!isBlank(identityName)) {
        $("#combos tr").filter(function () {
          let match = $(this).children("#tdColorIdentity").children().prop("outerHTML").indexOf(
                        replaceColorIdentityWithImageSources(
                          replaceNameWithColorIdentity(identityName)
                        ).join("")
                      );
          $(this).toggle(match > -1)
        });
      }
      if(!results.length == 0) {
        $("#combos tr").filter(function () {
          let match = $("#tdResult", this).children().prop("innerText").indexOf(results);
          $(this).toggle(match > -1)
        });
      }
    }
    function replaceColorIdentityWithName(identity) {
        if (isBlank(identity)) {
            return identity;
        } else {
            const colorMapper = {
                'w': 'white',
                'u': 'blue',
                'b': 'black',
                'r': 'red',
                'g': 'green',
                'c': 'colorless',
                'w,u': 'azorius',
                'w,b': 'orzhov',
                'w,r': 'boros',
                'w,g': 'selesnya',
                'u,b': 'dimir',
                'u,r': 'izzet',
                'u,g': 'simic',
                'b,r': 'rakdos',
                'b,g': 'golgari',
                'r,g': 'gruul',
                'w,u,b': 'esper',
                'w,u,r': 'jeskai',
                'w,u,g': 'bant',
                'w,b,r': 'mardu',
                'w,b,g': 'abzan',
                'w,r,g': 'naya',
                'u,b,r': 'grixis',
                'u,b,g': 'sultai',
                'u,r,g': 'temur',
                'b,r,g': 'jund',
                'w,u,b,r': 'sans-green',
                'w,u,b,g': 'sans-red',
                'w,b,r,g': 'sans-blue',
                'w,u,r,g': 'sans-black',
                'u,r,b,g': 'sans-white',
                'w,u,b,r,g': "wubrg"
            };

            return colorMapper[identity];
        }
    }
    function replaceNameWithColorIdentity(name) {
        if (isBlank(name)) {
            return name;
        } else {
            const colorMapper = {
                'white': 'w',
                'blue': 'u',
                'black': 'b',
                'red': 'r',
                'green': 'g',
                'colorless': 'c',
                'azorius': 'w,u',
                'orzhov': 'w,b',
                'boros': 'w,r',
                'selesnya': 'w,g',
                'dimir': 'u,b',
                'izzet': 'u,r',
                'simic': 'u,g',
                'rakdos': 'b,r',
                'golgari': 'b,g',
                'gruul': 'r,g',
                'esper': 'w,u,b',
                'jeskai': 'w,u,r',
                'bant': 'w,u,g',
                'mardu': 'w,b,r',
                'abzan': 'w,b,g',
                'naya': 'w,r,g',
                'grixis': 'u,b,r',
                'sultai': 'u,b,g',
                'temur': 'u,r,g',
                'jund': 'b,r,g',
                'sans-green': 'w,u,b,r',
                'sans-red': 'w,u,b,g',
                'sans-blue': 'w,b,r,g',
                'sans-black': 'w,u,r,g',
                'sans-white': 'u,r,b,g',
                "wubrg": 'w,u,b,r,g'
            };

            return colorMapper[name];
        }
    }

    function replaceColorIdentityWithImageSources(identity) {
        if (isBlank(identity)) {
            return "";
        } else {
            const colors = identity.split(",");
            const imagePaths = {
                'w': '<img src="images/mana/manaw.png" width="40" alt="white">',
                'u': '<img src="images/mana/manau.png" width="40" alt="blue">',
                'b': '<img src="images/mana/manab.png" width="40" alt="black">',
                'r': '<img src="images/mana/manar.png" width="40" alt="red">',
                'g': '<img src="images/mana/manag.png" width="40" alt="green">',
                'c': '<img src="images/mana/manac.png" width="40" alt="colorless">'
            };

            return colors.map(function (color) {
                return imagePaths[color];
            });
        }
    }
    function replaceColorIdentityWithMiniImageSources(identity) {
        if (isBlank(identity)) {
            return "";
        } else {
            const colors = identity.split(",");
            const imagePaths = {
                'w': '<img src="images/mana/manaw.png" width="20" alt="white">',
                'u': '<img src="images/mana/manau.png" width="20" alt="blue">',
                'b': '<img src="images/mana/manab.png" width="20" alt="black">',
                'r': '<img src="images/mana/manar.png" width="20" alt="red">',
                'g': '<img src="images/mana/manag.png" width="20" alt="green">',
                'c': '<img src="images/mana/manac.png" width="20" alt="colorless">'
            };

            return colors.map(function (color) {
                return imagePaths[color];
            });
        }
    }

  </script>
  
  </div>
</body>
<footer>
  <div class="container" width="50%">
    Magic: The Gathering and Commander are trademarks of Wizards of the Coast LLC in the United
    States and other countries. The Spellbook (EXO) imagery used on this site are copyright of Wizards of the Coast LLC.
    Commander Spellbook is not affiliated with, endorsed, sponsored, or specifically
    approved by Wizards of the Coast LLC. Commander Spellbook may use the trademarks and other intellectual property of
    Wizards of the Coast LLC, which is permitted under Wizards' Fan Site Policy. MAGIC: THE GATHERING® is a trademark of
    Wizards of the Coast. For more
    information about Wizards of the Coast or any of Wizards' trademarks or other intellectual property, please visit
    their
    website at <a href="https://company.wizards.com/">https://company.wizards.com/</a>.
  </div>

  <!-- Load combos.js after page loads -->
  <script src="js/combos.js"></script>
</footer>

</html>