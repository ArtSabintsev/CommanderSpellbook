<!DOCTYPE html>

<html>

<head>
  <!--Meta-->
  <title>Commander Spellbook - Combo Database for Commander (EDH)</title>
  <meta name="description"
    content="The Premier Magic: the Gathering Combo Database for the Commander / Elder Dragon Highlander (EDH) Format.">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!--Favicon-->
  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
  <link rel="manifest" href="favicon/site.webmanifest">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0LPW4VGE0F"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-0LPW4VGE0F');
  </script>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

  <!-- CSS -->
  <link rel="stylesheet" href="css/style.css" />

  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
  </script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous">
  </script>

  <!-- Deckbox -->
  <script src="https://deckbox.org/assets/external/tooltip.js"></script>
</head>

<body>
  <!--Nav Bar-->
  <nav class="navbar navbar-expand-xl navbar-light bg-light">
    <a class="navbar-brand" href="#">Commander Spellbook</a>
    <span class="navbar-text">
      Combo Database for EDH
    </span>
    <button class="navbar-toggler navbar-right" type="button" data-toggle="collapse" data-target="#navbar"
      aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar">
      <ul class="nav navbar-nav navbar-right ml-auto">
        <li class="nav-item">
          <button class="btn btn-success d-none d-lg-inline-block" data-toggle="modal"
            data-target="#submitComboModal">Submit</button>
          <a class="d-inline d-lg-none" role="button" data-toggle="modal" data-target="#submitComboModal">Submit a
            Combo</a>
        </li>
        <li class="nav-item">
          <a class="btn btn-dark d-none d-lg-inline-block" role="button" target="_blank"
            href="https://discord.com/invite/DkAyVJG">Discord</a>
          <a class="d-inline d-lg-none" role="button" target="_blank"
            href="https://discord.com/invite/DkAyVJG">Discord</a>
        </li>
        <li class="nav-item">
          <button class="btn btn-dark d-none d-lg-inline-block" data-toggle="modal"
            data-target="#metricsModal">Metrics</button>
          <a class="d-inline d-lg-none" role="button" data-toggle="modal" data-target="#metricsModal">Combo Metrics</a>
        </li>
        <li class="nav-item">
          <button class="btn btn-dark d-none d-lg-inline-block" data-toggle="modal"
            data-target="#dataModal">Database</button>
          <a class="d-inline d-lg-none" role="button" data-toggle="modal" data-target="#metricsModal">Data</a>
        </li>
      </ul>
    </div>
  </nav>

  <!--Main Div-->
  <div class="container-fluid" id="global">

    <!-- Input Form -->
    <input class="form-control w-100" id="card-input" ftype="text" placeholder="Loading Combos..."
      onkeyup="filterCombos()">

    <!-- Color Identity Selector -->
    <div id="identitySelector" style="display:flex; width:100%; justify-content: space-evenly; margin: 10px;">
      <div class="img-responsive" id="manaU">
        <div class="image-checkbox"><img src="images/mana/manaw.png" width="40" alt="white combos"></div>
      </div>
      <div class="img-responsive" id="manaU">
        <div class="image-checkbox"><img src="images/mana/manau.png" width="40" alt="blue combos"></div>
      </div>
      <div class="img-responsive" id="manaU">
        <div class="image-checkbox"><img src="images/mana/manab.png" width="40" alt="black combos"></div>
      </div>
      <div class="img-responsive" id="manaU">
        <div class="image-checkbox"><img src="images/mana/manar.png" width="40" alt="red combos"></div>
      </div>
      <div class="img-responsive" id="manaU">
        <div class="image-checkbox"><img src="images/mana/manag.png" width="40" alt="green combos"></div>
      </div>
      <div class="img-responsive" id="manaU">
        <div class="image-checkbox"><img src="images/mana/manac.png" width="40" alt="colorless combos"></div>
      </div>

      <!-- <div id="manaW">
        <label class="image-checkbox">
          <img class="img-responsive" src="images/mana/manaw.png" width="40" alt="white combos">
          <input type="checkbox" id="checkboxW" checked>
        </label>
      </div>
      <div class="img-responsive" id="manaU">
        <label class="image-checkbox">
          <img src="images/mana/manau.png" width="40" alt="blue combos">
          <input type="checkbox" id="checkboxU" checked>
        </label>
      </div>
      <div class="img-responsive" id="manaB">
        <label class="image-checkbox">
          <img src="images/mana/manab.png" width="40" alt="black combos">
          <input type="checkbox" id="checkboxB" checked>
        </label>
      </div>
      <div class="img-responsive" id="manaR">
        <label class="image-checkbox">
          <img src="images/mana/manar.png" width="40" alt="red combos">
          <input type="checkbox" id="checkboxR" checked>
        </label>
      </div>
      <div class="img-responsive" id="manaG">
        <label class="image-checkbox">
          <img src="images/mana/manag.png" width="40" alt="green combos">
          <input type="checkbox" id="checkboxG" checked>
        </label>
      </div>
      <div class="img-responsive" id="manaC">
        <label class="image-checkbox">
          <img src="images/mana/manac.png" width="40" alt="colorless combos">
          <input type="checkbox" id="checkboxC" checked>
        </label>
      </div> -->
    </div>

    <!-- Load metrics.js -->
    <script src="js/metrics.js"></script>

    <!-- Combos Table -->
    <div class="table-responive-sm">
      <table class="table" id="no-more-tables">
        <thead>
          <tr>
            <th width="15%">
              <center>CARDS</center>
            </th>
            <th width="15%">
              <center>IDENTITY</center>
            </th>
            <th width="20%">
              <center>PREREQUISITES</center>
            </th>
            <th width="25%">
              <center>STEPS</center>
            </th>
            <th width="15%">
              <center>RESULT</center>
            </th>
            <th width="10%">
              <center>COMBO ID</center>
            </th>
          </tr>
        </thead>
        <tbody id="combos"></tbody>
      </table>
    </div>
  </div>

  <!-- Submit Combo Modal -->
  <div class="modal fade" id="submitComboModal" tabindex="-1" role="dialog" aria-labelledby="submitComboModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="submitComboModalLabel">Want to Submit a Combo?</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          At this time, combo submissions are only being accepted via <a target="_blank"
            href="https://discord.gg/KDnvP5f">Discord</a>, as we've learned from experience that
          many of them require a discussion. If your combo isn't listed here, please join us on that platform to
          contribute to the catalog.
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <a role="button" class="btn btn-success" target="_blank" href="https://discord.gg/KDnvP5f">Join us on
            Discord</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Metrics Modal -->
  <div class="modal fade" id="metricsModal" tabindex="-1" role="dialog" aria-labelledby="metricsModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="metricsModalLabel">Combo Metrics</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <table class="table">
            <thead>
              <tr>
                <th width="38%">
                  <center>METRIC</center>
                </th>
                <th width="57%">
                  <center>IDENTITY</center>
                </th>
                <th width="5%">
                  <center>COUNT</center>
                </th>
              </tr>
            </thead>
            <tbody id="metrics"></tbody>
          </table>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Data Modal -->
  <div class="modal fade" id="dataModal" tabindex="-1" role="dialog" aria-labelledby="dataLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="dataLabel">Source Code, Database, and API</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          The data powering the website, and the source code for the website itself, are completely free and open
          source.
          <p>We encourage you copy and clone this data!</p>
          <ul>
            <li><a target="_blank" href="https://github.com/ArtSabintsev/CommanderSpellbook">Website Source Code on
                GitHub</a></li>
            <li><a target="_blank"
                href="https://docs.google.com/spreadsheets/d/1JJo8MzkpuhfvsaKVFVlOoNymscCt-Aw-1sob2IhpwXY/">Combo
                Database Backend on Google Sheets</a></li>
            <li><a target="_blank"
                href="https://sheets.googleapis.com/v4/spreadsheets/1JJo8MzkpuhfvsaKVFVlOoNymscCt-Aw-1sob2IhpwXY/values:batchGet?ranges=combos!A2:O&key=AIzaSyDzQ0jCf3teHnUK17ubaLaV6rcWf9ZjG5E">Combo
                Database GET API on Google Sheets</a></li>
          </ul>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- UI Updating Methods -->
  <script>
    // $(".image-checkbox").each(function () {
    //   if ($(this).find('input[type="checkbox"]').first().attr("checked")) {
    //     $(this).addClass('image-checkbox-checked');
    //   } else {
    //     $(this).removeClass('image-checkbox-checked');
    //   }
    // });

    // sync the state to the input
    var checkboxes = document.querySelectorAll('.image-checkbox');
    checkboxes.forEach(function (checkbox) {
      checkbox.classList.add('checked');
      checkbox.addEventListener('click', function (e) {
        e.target.classList.toggle('checked');

        // const isChecked = e.target.classList.contains('checked');
        filterCombos();
      });
    });

    // Re-apply table striping on search
    function tableStriping() {
      $("tr:visible").each(function (index) {
        $(this).css("background-color", !!(index & 1) ? "rgba(0,0,0,.05)" : "rgba(0,0,0,0)");
      });
    }

    // Re-apply table striping on search
    function filterCombos() {
      filter = $("#card-input").val().toLowerCase();
      $("#combos tr").filter(function () {
        let matchedText = $(this).text().toLowerCase().indexOf(filter)
        $(this).toggle(matchedText > -1 && inIdentity($(this)));
      });
      tableStriping();
    };

    // Filter by Color Identity
    function inIdentity(context) {
      white = $("#manaW").prop("checked");
      blue = $("#manaU").prop("checked");
      black = $("#manaB").prop("checked");
      red = $("#manaR").prop("checked");
      green = $("#manaG").prop("checked");
      colorless = $("#manaC").prop("checked");

      tdWhite = context.children("#tdColorIdentity").children().prop("outerHTML").indexOf("white") > -1;
      if (!white && tdWhite) {
        return false;
      }

      tdBlue = context.children("#tdColorIdentity").children().prop("outerHTML").indexOf("blue") > -1;
      if (!blue && tdBlue) {
        return false;
      }

      tdBlack = context.children("#tdColorIdentity").children().prop("outerHTML").indexOf("black") > -1;
      if (!black && tdBlack) {
        return false;
      }

      tdRed = context.children("#tdColorIdentity").children().prop("outerHTML").indexOf("red") > -1;
      if (!red && tdRed) {
        return false;
      }

      tdGreen = context.children("#tdColorIdentity").children().prop("outerHTML").indexOf("green") > -1;
      if (!green && tdGreen) {
        return false;
      }

      tdColorless = context.children("#tdColorIdentity").children().prop("outerHTML").indexOf("colorless") > -1;
      if (!colorless && tdColorless) {
        return false;
      }

      return true;
    }
  </script>

  </div>
</body>
<footer>
  <div class="container" width="50%">
    Magic: The Gathering and Commander are trademarks of Wizards of the Coast LLC in the United
    States and other countries. The Spellbook (EXO) imagery used on this site are copyright of Wizards of the Coast LLC.
    Commander Spellbook is not affiliated with, endorsed, sponsored, or specifically
    approved by Wizards of the Coast LLC. Commander Spellbook may use the trademarks and other intellectual property of
    Wizards of the Coast LLC, which is permitted under Wizards' Fan Site Policy. MAGIC: THE GATHERING® is a trademark of
    Wizards of the Coast. For more
    information about Wizards of the Coast or any of Wizards' trademarks or other intellectual property, please visit
    their
    website at <a href="https://company.wizards.com/">https://company.wizards.com/</a>.
  </div>

  <!-- Load combos.js after page loads -->
  <script src="js/combos.js"></script>
</footer>

</html>